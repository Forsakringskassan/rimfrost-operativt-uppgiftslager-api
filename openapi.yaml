openapi: 3.0.3
info:
  title: Operativt uppgiftslager API
  version: 1.0.0
  description: API för att hämta uppgifter som tilldelas handläggaren och uppdatera status på tilldelade uppgifter

paths:
  /uppgifter/{handlaggar_id}/next:
    post:
      tags: [UppgiftslagerController]
      operationId: postUppgiftslagerNext
      summary: Hämta ny uppgift
      description: Hämta ny uppgift som tilldelas handläggaren
      parameters:
        - name: handlaggar_id
          in: path
          required: true
          description: Handläggarens id
          schema:
            type: string
      responses:
        '200':
          description: Ny uppgift hämtad OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UppgiftNextResponse'
        '400':
          description: Bad request (t.ex. felaktigt handlaggar_id)
  /uppgifter/{uppgift_id}:
    patch:
      tags: [UppgiftslagerController]
      operationId: patchUppgiftStatus
      summary: Uppdatera status för uppgift
      description: Uppdatera status för uppgift
      parameters:
        - name: uppgift_id
          in: path
          required: true
          description: Uppgiftens id
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UppgiftStatusUpdateRequest'
      responses:
        '200':
          description: Uppgift uppdaterad OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UppgiftStatusUpdateResponse'
components:
  schemas:
    Personnummer:
      type: string
      description: Svenskt personnummer (12 siffror med bindestreck)
      pattern: '^\d{8}-\d{4}$'
      example: "19990101-0123"
    UppgiftNextResponse:
      type: object
      properties:
        uppgift_id:
          type: string
          description: Unikt id för hämtad uppgift
        uppgift_beskrivning:
          type: string
          description: Arbetsbeskrivning för uppgiften
        personnummer:
          $ref: '#/components/schemas/Personnummer'
    UppgiftStatusUpdateRequest:
      type: object
      required:
        - status
      properties:
        status:
          type: string
          description: Beskrivning av ny status
          example: "Utförd"
    UppgiftStatusUpdateResponse:
      type: object
      properties:
        uppgift:
          $ref: '#/components/schemas/Uppgift'
    Uppgift:
      type: object
      required:
        - uppgift_id
        - handlaggar_id
        - status
      properties:
        uppgift_id:
          type: string
          example: "abc123"
        handlaggar_id:
          type: string
          example: "42"
        beskrivning:
          type: string
          example: "Fråga om personen har anställning"
        status:
          type: string
          example: "Tilldelad"